<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8">
  <title>Jack Daniels Running Program</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1, h2 {
      text-align: center;
    }
    label {
      display: block;
      margin: 10px 0 5px;
    }
    input, select, button {
      padding: 8px;
      width: 100%;
      margin-bottom: 15px;
      font-size: 1em;
    }
    #result {
      background: white;
      padding: 15px;
      border-radius: 8px;
      margin-top: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #eee;
    }
  </style>
</head>
<body>
  <h1>Jack Daniels VDOT & Training Program</h1>

  <label for="time">Χρόνος (π.χ. 21:00):</label>
  <input type="text" id="time" placeholder="mm:ss">

  <label for="distance">Απόσταση:</label>
  <select id="distance">
    <option value="5k">5 km</option>
    <option value="10k">10 km</option>
    <option value="half">Ημιμαραθώνιος</option>
    <option value="marathon">Μαραθώνιος</option>
  </select>

  <label for="weeks">Διάρκεια Προγράμματος:</label>
  <select id="weeks">
    <option value="8">8 εβδομάδες</option>
    <option value="12">12 εβδομάδες</option>
    <option value="16">16 εβδομάδες</option>
    <option value="20">20 εβδομάδες</option>
    <option value="24">24 εβδομάδες</option>
  </select>

  <button onclick="calculate()">Υπολογισμός</button>

  <div id="result"></div>

  <script>
    const JackDanielsCalculator = {
      getVDOT: function(timeInSeconds, distance) {
        const meters = {
          '5k': 5000,
          '10k': 10000,
          'half': 21097.5,
          'marathon': 42195
        }[distance];

        const t = timeInSeconds / 60; // λεπτά
        const v = (meters / timeInSeconds) * 60; // m/min
        const VO2 = -4.60 + 0.182258 * v + 0.000104 * v * v;
        const VO2race = VO2 * (0.8 + 0.1894393 * Math.exp(-0.012778 * t) + 0.2989558 * Math.exp(-0.1932605 * t));
        return Math.round(VO2race * 10) / 10; // δεκαδικό για ακρίβεια
      },

      getTrainingPaces: function(vdot) {
        function paceFromVDOT(percent) {
          const VO2 = vdot * percent;
          const a = 0.000104, b = 0.182258, c = -(VO2 + 4.6);
          const v = (-b + Math.sqrt(b*b - 4*a*c)) / (2*a); // m/min
          const speed = v / 60; // m/s
          const paceSecPerKm = 1000 / speed; 
          return JackDanielsCalculator.formatPace(paceSecPerKm);
        }

        return {
          easySlow: paceFromVDOT(0.65),
          easyFast: paceFromVDOT(0.79),
          marathon: paceFromVDOT(0.84),
          threshold: paceFromVDOT(0.88),
          interval: paceFromVDOT(1.00),
          repetition: paceFromVDOT(1.06)
        };
      },

      formatPace: function(secondsPerKm) {
        const minutes = Math.floor(secondsPerKm / 60);
        const seconds = Math.round(secondsPerKm % 60);
        return `${minutes}:${seconds.toString().padStart(2, '0')}`;
      }
    };

    function parseTime(str) {
      const parts = str.split(":");
      if (parts.length !== 2) return null;
      const minutes = parseInt(parts[0], 10);
      const seconds = parseInt(parts[1], 10);
      return minutes * 60 + seconds;
    }

    function generateProgram(weeks, paces) {
      let schedule = [];
      for (let w = 1; w <= weeks; w++) {
        schedule.push([
          `Εβδομάδα ${w}`,
          `Δευτέρα: Easy ${paces.easySlow} – ${paces.easyFast}/km`,
          `Τρίτη: Διαλειμματική ${paces.interval}/km (8x400m)`,
          `Τετάρτη: Easy ${paces.easySlow} – ${paces.easyFast}/km`,
          `Πέμπτη: Threshold ${paces.threshold}/km (20 λεπτά)`,
          `Παρασκευή: Ρεπό`,
          `Σάββατο: Long Run ${paces.marathon}/km`,
          `Κυριακή: Easy ${paces.easySlow} – ${paces.easyFast}/km`
        ]);
      }
      return schedule;
    }

    function calculate() {
      const timeStr = document.getElementById("time").value;
      const distance = document.getElementById("distance").value;
      const weeks = parseInt(document.getElementById("weeks").value, 10);
      const timeInSeconds = parseTime(timeStr);

      if (!timeInSeconds) {
        alert("Δώσε χρόνο σε μορφή mm:ss");
        return;
      }

      const vdot = JackDanielsCalculator.getVDOT(timeInSeconds, distance);
      const paces = JackDanielsCalculator.getTrainingPaces(vdot);

      let html = `<h2>VDOT: ${vdot}</h2>`;
      html += `<p><b>Easy:</b> ${paces.easySlow} – ${paces.easyFast}/km<br>
               <b>Marathon:</b> ${paces.marathon}/km<br>
               <b>Threshold:</b> ${paces.threshold}/km<br>
               <b>Interval:</b> ${paces.interval}/km<br>
               <b>Repetition:</b> ${paces.repetition}/km</p>`;

      const program = generateProgram(weeks, paces);
      html += `<h2>Πρόγραμμα ${weeks} Εβδομάδων</h2>`;
      html += `<table><tr><th>Εβδομάδα</th><th>Ημέρα</th><th>Προπόνηση</th></tr>`;

      program.forEach(week => {
        for (let i = 1; i < week.length; i++) {
          html += `<tr><td>${week[0]}</td><td>${week[i].split(":")[0]}</td><td>${week[i].split(":")[1]}</td></tr>`;
        }
      });

      html += `</table>`;

      document.getElementById("result").innerHTML = html;
    }
  </script>
</body>
</html>
